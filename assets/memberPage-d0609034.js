import{_ as E,A as ae,u as H,i as O,a as N,r as I,j as f,l as G,o as J,s as se,B as z,c as i,d as r,f as t,F as k,t as d,C as oe,q as $,m as M,v as L,g as S,L as ne,e as c,w as P,D as T,p as K,h as Q,E as le}from"./index-34d9ee9b.js";import{_ as ie}from"./plus-b341551d.js";import{s as re}from"./vue3-datepicker.esm-48161463.js";import{S as w}from"./service-9db6be5c.js";import{h as B}from"./moment-fbc5633a.js";import{t as W}from"./title-dot-31571a1f.js";const de="/Aoido_web/assets/logOut-b6b33942.svg",me="/Aoido_web/assets/info-c287daaa.svg";const X=b=>(K("data-v-e01606be"),b=b(),Q(),b),ue={class:"memberPage_content"},_e={class:"memberPage_img_container"},ce={class:"memberPage_Upload"},ge={class:"memberPage_Img"},pe=["src"],be=["src"],he={key:1,style:{width:"40px"},src:ie},ve={class:"memberPage_img_container_group"},fe={class:"memberPage_Item"},ye={class:"memberPage_Item_button_title"},Ce={class:"memberPage_Item_container_group"},Pe=X(()=>t("img",{class:"memberPage_Item_button_title_img",src:me},null,-1)),Ie=["value"],ke={class:"memberPage_Item_button",type:"submit"},$e={class:"memberPage_Item_content"},we={class:"memberPage_Item_label"},Ue={class:"memberPage_Item_input"},De={class:"createMember_errorMessage"},Ve={class:"memberPage_Item_content"},Ae={class:"memberPage_Item_label"},Ne={class:"memberPage_Item_input"},Se={class:"memberPage_Item_content"},xe={class:"memberPage_Item_label"},Fe={class:"memberPage_Item_input"},Me={class:"memberPage_Item_select"},Le=["value"],Te=X(()=>t("a",null," / ",-1)),Be=["value"],Ee={class:"memberPage_Item_content"},Oe={class:"memberPage_Item_label"},je={class:"memberPage_Item_input"},qe={class:"memberPage_Item_content"},Re={class:"memberPage_Item_label"},Ge={class:"memberPage_Item_input"},ze={class:"createMember_errorMessage"},We={__name:"memberPageInfo",setup(b){const{handleSubmit:U,form:h,errors:A}=ae(),m=H(),D=O(),o=N({uesrName:"",birth:new Date,phone:"",addres:"",mail:"",City:"",Town:"",photo:""}),V=N({data:{}}),v=N({City:"",Town:""}),g=I(null),p=I(null),n=I(null),_=I(""),y=I(""),x=I(f.get("language")),j=U(s=>{q()}),Y=s=>{const e=s.target.files;if(e&&["image/jpg","image/jpeg","image/png"].includes(e[0].type)&&e[0].size<1*1024*1024){const a=new FileReader;a.onload=C=>{n.value=C.target.result},a.readAsDataURL(e[0]),p.value=e[0]}else n.value=null,p.value=null,m.isAlertBoxComfirmChange(!0),m.AlertMessageChange("圖像不支援")},Z=async()=>{if(!p.value)return;const s=new FormData;s.append("file",p.value),m.isloadingChange(!0);const e=await w.postUploadUserImage(s);(e==null?void 0:e.status)==="success"&&(e!=null&&e.data)&&(o.photo=e.data.imageUrl,q()),m.isloadingChange(!1)},q=async()=>{let s=f.get("token"),e={uesrName:o.uesrName,birth:o.birth,phone:o.phone,city:_.value,town:y.value,addres:o.addres,mail:o.mail,photo:o.photo,token:s};if(_.value&&y.value){m.isloadingChange(!0);const a=await w.postUploadUser(e);(a==null?void 0:a.status)==="success"&&(a!=null&&a.data)&&R(),m.isloadingChange(!1)}else m.isAlertBoxComfirmChange(!0),m.AlertMessageChange("資料未齊全")},R=async()=>{let e={token:f.get("token")};const a=await w.postUserinfo(e);m.isloadingChange(!0),(a==null?void 0:a.status)==="success"&&(a!=null&&a.data)&&(o.uesrName=a==null?void 0:a.data[0].uesrName,o.phone=a==null?void 0:a.data[0].phone,o.addres=a==null?void 0:a.data[0].addres,o.mail=a==null?void 0:a.data[0].mail,o.photo=a==null?void 0:a.data[0].photo,_.value=a==null?void 0:a.data[0].city,y.value=a==null?void 0:a.data[0].town),m.isloadingChange(!1)},ee=async()=>{const s=await w.getCountyItems();if((s==null?void 0:s.status)==="success"&&(s!=null&&s.data)){V.data=s.data;const e=Object.keys(s.data);v.City=e.filter(a=>a!=="_id"),v.Town=V.data[_.value]}},te=()=>{D.push({name:"memberPage_handPassWord"})};return G(_,(s,e)=>{v.Town=V.data[_.value],!["",null,void 0].includes(e)&&s!==e&&(y.value="")}),G(x,(s,e)=>{console.log(e),console.log(s),!["",null,void 0].includes(e)&&s!==e&&m.defaultLanguageChange(s)}),J(()=>{R(),ee()}),se("userList",o),(s,e)=>{const a=z("ErrorMessage"),C=z("Field");return i(),r("div",ue,[t("div",_e,[t("label",ce,[t("div",ge,[n.value?(i(),r("img",{key:0,src:n.value},null,8,pe)):(i(),r(k,{key:1},[o.photo?(i(),r("img",{key:0,src:o.photo},null,8,be)):(i(),r("img",he))],64))]),t("input",{type:"file",ref_key:"fileInput",ref:g,style:{display:"none"},onChange:Y},null,544)]),t("div",ve,[t("button",{class:"memberPage_img_container_button",onClick:Z},d(s.$t("個人圖片變更")),1),t("button",{class:"memberPage_img_container_button",onClick:e[0]||(e[0]=l=>te())},d(s.$t("密碼變更")),1)])]),t("div",fe,[t("form",{onSubmit:e[9]||(e[9]=oe((...l)=>$(j)&&$(j)(...l),["prevent"])),class:"memberPage_Item_container"},[t("div",ye,[t("div",Ce,[Pe,M(t("select",{class:"memberPage_Item_container_select","onUpdate:modelValue":e[1]||(e[1]=l=>x.value=l)},[(i(!0),r(k,null,S($(ne),(l,u)=>(i(),r("option",{key:u,value:l.value},d(l.lang),9,Ie))),128))],512),[[L,x.value]])]),t("button",ke,d(s.$t("變更")),1)]),c(C,{name:"uesrName",modelValue:o.uesrName,"onUpdate:modelValue":e[2]||(e[2]=l=>o.uesrName=l),rules:"required"},{default:P(({field:l})=>[t("label",$e,[t("a",we,d(s.$t("名字"))+":",1),t("div",Ue,[t("input",T({type:"text"},l),null,16),c(a,{name:"uesrName"},{default:P(({message:u})=>[t("a",De,d(s.$t(u)),1)]),_:1})])])]),_:1},8,["modelValue"]),c(C,{name:"birth",label:"birth"},{default:P(()=>[t("label",Ve,[t("a",Ae,d(s.$t("生日"))+":",1),t("div",Ne,[c($(re),{modelValue:o.birth,"onUpdate:modelValue":e[3]||(e[3]=l=>o.birth=l),style:{width:"170px",height:"2rem","padding-left":"7.5px"}},null,8,["modelValue"])])])]),_:1}),c(C,{name:"phone",label:"phone",modelValue:o.phone,"onUpdate:modelValue":e[6]||(e[6]=l=>o.phone=l)},{default:P(({field:l})=>[t("label",Se,[t("a",xe,d(s.$t("縣市/鄉鎮"))+":",1),t("div",Fe,[t("div",Me,[M(t("select",{style:{width:"65px",height:"2rem",margin:"0px 10px"},"onUpdate:modelValue":e[4]||(e[4]=u=>_.value=u)},[(i(!0),r(k,null,S(v.City,(u,F)=>(i(),r("option",{key:F,value:u},d(u),9,Le))),128))],512),[[L,_.value]]),Te,M(t("select",{style:{width:"65px",height:"2rem",margin:"0px 10px"},"onUpdate:modelValue":e[5]||(e[5]=u=>y.value=u)},[(i(!0),r(k,null,S(v.Town,(u,F)=>(i(),r("option",{key:F,value:u},d(u),9,Be))),128))],512),[[L,y.value]])])])])]),_:1},8,["modelValue"]),c(C,{name:"addres",label:"addres",modelValue:o.addres,"onUpdate:modelValue":e[7]||(e[7]=l=>o.addres=l)},{default:P(({field:l})=>[t("label",Ee,[t("a",Oe,d(s.$t("地址"))+":",1),t("div",je,[t("input",T({type:"text"},l),null,16)])])]),_:1},8,["modelValue"]),c(C,{name:"mail",label:"mail",modelValue:o.mail,"onUpdate:modelValue":e[8]||(e[8]=l=>o.mail=l),rules:"required|mail"},{default:P(({field:l})=>[t("label",qe,[t("a",Re,d(s.$t("郵箱"))+":",1),t("div",Ge,[t("input",T({class:"memberPage_Item_input",type:"text"},l),null,16),c(a,{name:"mail"},{default:P(({message:u})=>[t("a",ze,d(s.$t(u)),1)]),_:1})])])]),_:1},8,["modelValue"])],32)])])}}},He=E(We,[["__scopeId","data-v-e01606be"]]),Je="/Aoido_web/assets/pin-000cad29.svg";const Ke={class:"memberPageCoupon_container"},Qe={class:"memberPageCoupon_Item"},Xe={key:0,class:"memberPageCoupon_container_img",src:Je},Ye={class:"memberPageCoupon_Item_description"},Ze={class:"memberPageCoupon_Item_button"},et={key:0,disabled:!0},tt={key:0,disabled:!0},at=["onClick"],st={key:1,disabled:!0},ot={__name:"memberPageCoupon",setup(b){const U=O(),h=H(),A=B(),m=I(f.get("id")),D=N({data:{}}),o=async()=>{let p={token:f.get("token")};h.isloadingChange(!0);const n=await w.postFindAllCoupon(p);(n==null?void 0:n.status)==="success"&&(n!=null&&n.data)&&(D.data=n.data),h.isloadingChange(!1)},V=async g=>{let p=f.get("id");if(p){let n={id:g.id,user:p};h.isloadingChange(!0);const _=await w.patchUpdateCouponUser(n);(_==null?void 0:_.status)==="success"&&(h.isAlertBoxComfirmChange(!0),h.AlertMessageChange("已領取"),o()),h.isloadingChange(!1)}else U.push("/homePage")},v=g=>g.filter(n=>n===m.value).length>0;return J(()=>{o()}),(g,p)=>(i(),r("div",Ke,[(i(!0),r(k,null,S(D.data,(n,_)=>(i(),r("div",Qe,[v(n.user)?(i(),r("img",Xe)):le("",!0),t("div",Ye,[t("a",null,d(n.describe),1),t("a",null,d($(B)(n.startDate).format("L"))+" - "+d($(B)(n.endDate).format("L")),1)]),t("div",Ze,[Number(n.count)<=0?(i(),r("button",et,d(g.$t("已使用")),1)):(i(),r(k,{key:1},[v(n.user)?(i(),r("button",tt,d(g.$t("已領取")),1)):(i(),r(k,{key:1},[$(A).isBetween(n.startDate,n.endDate)?(i(),r("button",{key:0,onClick:y=>V(n)},d(g.$t("已領取")),9,at)):(i(),r("button",st,d(g.$t("過期")),1))],64))],64))])]))),256))]))}},nt=E(ot,[["__scopeId","data-v-5d9ec8bc"]]);const lt=b=>(K("data-v-221cd24f"),b=b(),Q(),b),it={class:"memberPage_container"},rt={class:"memberPage_logout_button"},dt=lt(()=>t("img",{style:{width:"15px",height:"15px"},src:de},null,-1)),mt={__name:"memberPage",setup(b){const U=O(),h=()=>{f.remove("password"),f.remove("token"),U.push("/loginPage")};return(A,m)=>(i(),r("div",it,[c(W,{msg:"個人情報"}),c(He),c(W,{msg:"優惠卷"}),c(nt),t("div",rt,[t("button",{type:"button",onClick:m[0]||(m[0]=D=>h())},[t("a",null,d(A.$t("登出")),1),dt])])]))}},ht=E(mt,[["__scopeId","data-v-221cd24f"]]);export{ht as default};
